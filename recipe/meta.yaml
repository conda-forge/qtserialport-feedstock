{% set version = "5.15.8" %}
{% set ver = '.'.join(version.split('.')[:2]) %}

package:
  name: qtserialport
  version: {{ version }}

source:
  url: http://download.qt.io/official_releases/qt/{{ ver }}/{{ version }}/submodules/qtserialport-opensource-src-{{ version }}.tar.xz
  sha256: 5beca29ffb31225f9e3a9a3b909cb96efc557c17dcef3467235c075a7dbb2812

build:
  # QtSerialPort already comes with Windows Qt builds but the included bld.bat
  # should work (just doesn't package anything because files already exist)
  skip: true  # [win]
  number: 0

requirements:
  build:
    - perl
    - cmake
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - qt-main {{ version }}  # [build_platform != target_platform]
  host:
    - qt-main {{ version }}
  run:
    # qt-main has a run export of x.x
    # but because this is a subpackage of qt
    # I would like to pin it to x.x.x
    - qt-main {{ version }}

test:
  commands:
    - test -f ${PREFIX}/lib/libQt5SerialPort${SHLIB_EXT}  # [not win]

about:
  home: https://github.com/qt/qtserialport
  license: GPL-2.0-or-later
  license_family: GPL
  license_file: LICENSE.GPL3
  summary: 'The QtSerialPort module is an add-on module for the Qt5 library, providing a single interface for both hardware and virtual serial ports.'
  description: |
    The QtSerialPort module is an add-on module for the Qt5 library, providing a single
    interface for both hardware and virtual serial ports. Serial interfaces, due to
    their simplicity and reliability, are still popular in some industries like the
    development of embedded systems, robotics, etc. Using the QtSerialPort module,
    developers can significantly reduce the time needed to implement Qt applications
    that require access to a serial interface.
  doc_url: http://doc.qt.io/qt-5/qtserialport-index.html
  dev_url: https://github.com/qt/qtserialport

extra:
  recipe-maintainers:
    - ceholden
